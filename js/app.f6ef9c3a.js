(function(t){function e(e){for(var o,s,i=e[0],c=e[1],l=e[2],d=0,m=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&m.push(a[s][0]),a[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);u&&u(e);while(m.length)m.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(o=!1)}o&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},a={app:0},r=[];function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"0059":function(t,e,n){},1:function(t,e){},"2e9b":function(t,e,n){},"370f":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAhQAAAIUB4uz/wQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIfSURBVEiJ7ZLdS1NhHMc/z3P2xuZsa6OGYRQpoZMMqgsr5k3QpUlQf0BUVwleRlGjiK6K7vLSRRAGDaMuA1MCEQpZRa6LLpQiQkop29rLOb8uTN3ZqTlw0I1feOA8L9+35zmwif8NVe9BGYu3oYxBFnwJtDmg+l6NNcxAXuwNUvZmgRY+B8EQk63mDnVs6st6XJeM728HGQLdDlaKROaKUojtVMnXjZKW1bmpDPLSDwzZggiKB0evY3AGkRlM47wLsVJAD5gAl5nofgOZhzYDQ78HKWJZnuXeAh7juSPuyOHTKLmEBUAMbQ1rkLj9Pqyuap5KTM+z+8A0TRHwmBBTP9TxyazDQIhXLXRpUI/XlBC0furg5a4dIdp6kHgvRHLAUlBmTlxwGFjypMpwVJPLncUfukVsD3T0Kg71D8jSje0AIkktueQplDUKGJVMvn28I+/6bougASR7ch8d/hEiOQgUYYsvRaj5nAKQxZthvIWv2P+qOcAPRG2pptL21G63hXJZFPMu2/q2tl2qMz2rAVTo4gLwoarwTof431AqaYe4L1BUnelZYLneH0yuK1YvvE1zK58VBmq8YQYe36rWmsEveQTkNyyuDWgOX3UYqHBykVLhLoWf1BxlXXsEoi9V671PK7r2x8k8e4tZqJ1wPlh7P//9ta2QbbNcLNVm1wFTipVTewN3eYKyvg/a+08BT7mnhnwJzOGN5NtE4/EbAF7EWIfC+84AAAAASUVORK5CYII="},"4bbb":function(t,e,n){"use strict";var o=n("fada"),a=n.n(o);a.a},"5ca1":function(t,e,n){"use strict";var o=n("f255"),a=n.n(o);a.a},"72f9":function(t,e,n){},"78d4":function(t,e,n){"use strict";var o=n("96b8"),a=n.n(o);a.a},"803a":function(t,e,n){"use strict";var o=n("e294"),a=n.n(o);a.a},8077:function(t,e,n){t.exports=n.p+"img/back.80dd3782.jpg"},9224:function(t){t.exports=JSON.parse('{"a":"0.1.4"}')},"96b8":function(t,e,n){},a561:function(t,e,n){"use strict";var o=n("c9ca"),a=n.n(o);a.a},a78d:function(t,e,n){"use strict";var o=n("b831"),a=n.n(o);a.a},a968:function(t,e,n){"use strict";var o=n("f52b"),a=n.n(o);a.a},b831:function(t,e,n){},c9ca:function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),a=n("03a5"),r=n.n(a),s=n("0086"),i=n.n(s),c=n("ee98"),l=n.n(c),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view"),n("span",{staticStyle:{opacity:"0.3","font-size":"8px",position:"fixed",bottom:"0"}},[t._v(" version: "+t._s(t.version)+" ")]),n("notifications",{attrs:{position:"bottom center"}})],1)},d=[],m=(n("e29a"),n("9224")),p={data:function(){return{version:m["a"]}}},f=p,h=n("2877"),v=Object(h["a"])(f,u,d,!1,null,null,null),y=v.exports,_=n("9483");Object(_["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});var k=n("8c4f"),g=n("2f62");o["default"].use(g["a"]);var b=new g["a"].Store({state:{user:null},mutations:{setUser:function(t,e){t.user=e}},actions:{},modules:{}}),C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Signin",{attrs:{"def-room":t.defRoom},on:{userFetched:t.setUser}})},w=[],R=(n("b0c0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[t._v(" Welcome to the Crest online! "),n("br"),n("br"),n("form",{on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[t.error?n("span",{staticStyle:{color:"red"}},[t._v(" "+t._s(t.error))]):t._e(),n("br"),n("label",{attrs:{for:"name"}},[t._v("Enter your name")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{required:"",id:"name",name:"name",type:"text"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),n("br"),n("label",{attrs:{for:"room"}},[t._v("Enter room code")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.room,expression:"room"}],attrs:{id:"room",name:"room",type:"text"},domProps:{value:t.room},on:{input:function(e){e.target.composing||(t.room=e.target.value)}}}),n("br"),n("button",{attrs:{type:"submit"}},[t._v(t._s(t.room?"Присоединиться":"Начать игру"))]),n("br"),t.room&&t.name?n("button",{attrs:{type:"button"},on:{click:t.playAsOld}},[t._v("Войти как "+t._s(t.name))]):t._e()])])}),A=[],S=n("bc3a"),x=n.n(S);n("99af");function j(){var t=window.location;t.protocol,t.hostname;return"https://crest-server.herokuapp.com/"}var E=j,O=x.a.create({baseURL:E(),timeout:15e3,withCredentials:!0}),T=O,P={name:"Signin",props:["defRoom"],data:function(){return{name:"",room:this.defRoom,error:""}},methods:{handleSubmit:function(){var t=this;T.post("user",{name:this.name,room:this.room}).then((function(e){t.$emit("userFetched",e.data)})).catch((function(e){t.error=e.response.data.message}))},playAsOld:function(){var t=this;T.post("old_user",{name:this.name,room:this.room}).then((function(e){t.$emit("userFetched",e.data)})).catch((function(e){t.error=e.response.data.message}))}}},U=P,I=Object(h["a"])(U,R,A,!1,null,null,null),M=I.exports,$={name:"Home",props:["defRoom"],components:{Signin:M},computed:{user:function(){return this.$store.state.user}},methods:{getUser:function(){return T.get("user").then((function(t){return t.data}))},setUser:function(t){t&&(this.$store.commit("setUser",t),this.$router.push({name:"Room",params:{id:t.room}}))}},mounted:function(){var t=this;this.getUser().then((function(e){e&&t.$dialog.confirm("Are you ".concat(e.name,"?"),{okText:"Yes",cancelText:"No"}).then((function(){return t.setUser(e)}))}))}},D=$,B=Object(h["a"])(D,C,w,!1,null,null,null),G=B.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"room"},[n("div",{staticClass:"room_info"},[n("span",{staticStyle:{opacity:".3"}},[t._v("#"+t._s(t.id))]),n("div",{staticClass:"room_controller_wrapper"},[n("HamburgerMenu",{staticClass:"room_controller_toggle",attrs:{"is-close":t.showSidebar},on:{click:function(e){t.showSidebar=!t.showSidebar}}})],1),t.showSidebar?n("room-controller",{attrs:{"room-id":t.id,"admin-id":t.adminId,socket:t.socket}}):t._e()],1),n("Players",{attrs:{players:t.opponents,"admin-id":t.adminId,socket:t.socket}}),t.game?n("Desk",{attrs:{cards:t.game.desk}}):t._e(),t.socket?n("PlayerController",{attrs:{socket:t.socket,adminId:t.adminId}}):t._e()],1)},N=[],Y=(n("4de4"),n("c740"),n("fb6a"),n("2909")),W=n("8055"),H=n.n(W),Q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"players"},t._l(t.players,(function(e,o){return n("div",{key:e.id,staticClass:"player_wrapper",style:t.calculatePlayerPosition(o,t.players.length)},[n("Player",t._b({attrs:{"is-admin":e.id===t.adminId,socket:t.socket}},"Player",e,!1))],1)})),0)},Z=[],V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"player_block",class:{"player_block-turn":"turn"===t.state,"player_block-offline":!t.isConnected,"player_block-not_ready":!t.isReady}},[t.isAdmin?n("img",{staticClass:"player_admin",attrs:{src:t.crownImg,alt:"admin"}}):t._e(),n("div",{staticClass:"player_state"},[t._v(" "+t._s(t.emoji)+" ")]),n("span",{staticClass:"player_name"},[t._v(t._s(t.name))]),n("div",{staticClass:"player_hands"},[t._l(t.cardsCount,(function(e){return n("div",{key:e,staticClass:"card_back",style:Object.assign({},{backgroundImage:"url("+t.cardBackImg+")"},t.calculateCardStyle(e,t.cardsCount))})})),n("div",{staticClass:"card_back card_back_animation card_back_animation-take",class:{"card_back_animation-take-play":"take"===t.animate},style:{backgroundImage:"url("+t.cardBackImg+")"}}),n("div",{staticClass:"card_back card_back_animation card_back_animation-move",class:{"card_back_animation-move-play":"move"===t.animate},style:{backgroundImage:"url("+t.cardBackImg+")"}})],2),n("div",{staticClass:"player_emotions"},t._l(t.emotions,(function(e){return n("div",{key:e.id,staticClass:"player_emotion"},[t._v(" "+t._s(e.value)+" ")])})),0)])},K=[],q=(n("a434"),n("d3b7"),n("25f0"),n("8077")),X=n.n(q),z=n("370f"),J=n.n(z),F={name:"Player",props:["socket","id","name","state","emoji","cardsCount","isReady","isConnected","firstWinCount","loseCount","isAdmin"],data:function(){return{cardBackImg:X.a,crownImg:J.a,animationTimeout:null,animate:!1,emotions:[]}},computed:{playerState:function(){return this.isConnected?this.isReady?"Ready":"Waiting":"Offline"}},watch:{cardsCount:function(t,e){var n=this;clearTimeout(this.animationTimeout),this.animate=e>t?"move":"take",this.animationTimeout=setTimeout((function(){n.animate=!1}),300)}},methods:{calculateCardStyle:function(t,e){var n=-30/(e+1),o=n*t+15;return{transform:"rotate(".concat(o,"deg)")}},listenSocket:function(){var t=this;this.socket.on("emote",(function(e,n){if(t.id===e){var o=(new Date).getTime().toString();t.emotions.push({id:o,value:n}),setTimeout((function(){var e=Object(Y["a"])(t.emotions),n=e.findIndex((function(t){return t.id===o}));-1!==n&&(e.splice(n,1),t.emotions=Object(Y["a"])(e))}),1500)}}))}},mounted:function(){this.listenSocket()}},tt=F,et=(n("78d4"),Object(h["a"])(tt,V,K,!1,null,null,null)),nt=et.exports,ot={name:"Players",components:{Player:nt},props:["players","adminId","socket"],methods:{calculatePlayerPosition:function(t,e){var n=180/(e+1),o=n*(t+1)-90;return{transform:"rotate(".concat(o,"deg)")}}}},at=ot,rt=(n("a78d"),Object(h["a"])(at,Q,Z,!1,null,null,null)),st=rt.exports,it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"player_controller",style:{zIndex:t.showEmojiGallery?"1000":"1"}},[n("div",{staticClass:"player_controller_avatar"},[n("div",{staticClass:"player_state",class:{"player_state-is_turn":"turn"===t.player.state},on:{click:t.openEmojiGallery}},[t._v(" "+t._s(t.showEmojiGallery?"ⓧ":t.player.emoji)+" "),n("div",{staticClass:"player_controller_emotions"},t._l(t.emotions,(function(e){return n("div",{key:e.id,staticClass:"player_emotion"},[t._v(" "+t._s(e.value)+" ")])})),0)]),t.showEmojiGallery&&!t.player.isReady?n("player-emoji-gallery",{on:{setAvatar:t.changeAvatar,close:function(e){t.showEmojiGallery=!1}}}):t._e(),t.showEmojiGallery&&t.player.isReady?n("player-emotion-controller",{on:{setEmotion:t.sendEmotion}}):t._e()],1),"wait"===t.player.state?[n("div",{staticClass:"player_controller-ready_controller"},[n("span",{staticClass:"player_controller-ready_state"},[t._v(" "+t._s(t.isReady?"You ready":"Waiting")+" ")]),n("button",{staticClass:"player_controller-ready_button",class:{"player_controller-ready_button-success":!t.isReady,"player_controller-ready_button-danger":t.isReady},on:{click:function(e){return t.setReadyState(!t.isReady)}}},[t._v(" "+t._s(t.isReady?"Wait":"Ready")+" ")]),t.isReady&&t.player.id===t.adminId?n("button",{staticClass:"player_controller-ready_button player_controller-ready_button-success",on:{click:t.startGame}},[t._v(" Go! ")]):t._e()])]:["turn"===t.player.state?n("button",{staticClass:"player_controller-take_card",on:{click:t.takeCard}},[t._v(" Take card ")]):t._e(),t.player&&t.player.cards?n("PlayerHand",{attrs:{cards:t.player.cards,"is-turn":"turn"===t.player.state},on:{cardmove:t.sendCard}}):t._e()]],2)},ct=[],lt=n("5530"),ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"handWrapper",staticClass:"player_controller-hand"},[t.isMounted?t._l(t.sortedCards,(function(e,o){return n("div",{directives:[{name:"touch",rawName:"v-touch:start",value:t.onTouchStart,expression:"onTouchStart",arg:"start"},{name:"touch",rawName:"v-touch:moving",value:t.onTouchMoving,expression:"onTouchMoving",arg:"moving"},{name:"touch",rawName:"v-touch:end",value:t.onTouchEnd,expression:"onTouchEnd",arg:"end"}],key:e.id,staticClass:"player_controller-card_wrapper",class:{holding:t.selectedCard===o,dropping:t.selectedCard===o&&t.isOnDropZone},style:o===t.selectedCard?t.calculateActiveCardTransform():t.calculateCardTransform(o,t.sortedCards.length),on:{mousedown:t.onMouseDown,dragstart:t.preventEvent}},[n("Card",t._b({staticClass:"player_controller-card"},"Card",e,!1))],1)})):t._e()],2)},dt=[],mt=(n("c975"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card",on:{click:t.emitClick}},[n("img",{staticStyle:{width:"100%"},attrs:{src:t.imageSrc,alt:""}})])}),pt=[],ft={name:"card",props:["id","suit","value"],computed:{imageSrc:function(){return"/img/cards/".concat(this.id,".jpg")}},methods:{emitClick:function(){this.$emit("click")}}},ht=ft,vt=Object(h["a"])(ht,mt,pt,!1,null,null,null),yt=vt.exports,_t=["ad","kd","qd","jd","1d","9d","8d","7d","6d","ah","kh","qh","jh","1h","9h","8h","7h","6h","as","ks","qs","js","1s","9s","8s","7s","6s","ac","kc","qc","jc","1c","9c","8c","7c","6c"];function kt(t){return t.sort((function(t,e){return _t.indexOf(t.id)-_t.indexOf(e.id)}))}var gt=kt,bt={name:"PlayerHand",components:{Card:yt},props:["cards","isTurn"],data:function(){return{isMounted:!1,pointer:{x:0,y:0},elem:{x:0,y:0},selectedCard:-1,isOnDropZone:!1}},computed:{sortedCards:function(){return gt(this.cards)},handWrapperRef:function(){return this.$refs.handWrapper}},methods:{preventEvent:function(t){t.preventDefault()},calculateActiveCardTransform:function(){return{left:"".concat(this.elem.x,"px"),top:"".concat(this.elem.y,"px")}},calculateCardTransform:function(t,e){var n=(this.handWrapperRef?this.handWrapperRef.clientWidth:320)-30,o=30/(e+1),a=o*t-15,r=n/e>30?30:n/e,s=(n-r*e)/2,i=10+s+r*t-r/2,c=.5*Math.pow(Math.abs(e/2-t),2);return{transform:"rotate(".concat(a,"deg)"),left:"".concat(i,"px"),top:"".concat(c,"px")}},setActiveElem:function(t){this.selectedCard=Object(Y["a"])(this.handWrapperRef.children).indexOf(t),t.classList.add("holding"),this.elem.x=t.getBoundingClientRect().x-this.handWrapperRef.getBoundingClientRect().x,this.elem.y=t.getBoundingClientRect().y-this.handWrapperRef.getBoundingClientRect().y},onTouchStart:function(t){this.pointer.x=t.touches[0].clientX,this.pointer.y=t.touches[0].clientY,this.setActiveElem(t.target)},onMouseDown:function(t){this.pointer.x=t.clientX,this.pointer.y=t.clientY,this.setActiveElem(t.target),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onTouchEnd)},onTouchEnd:function(){this.isOnDropZone&&this.handleCardMove(),this.selectedCard=-1,this.isOnDropZone=!1,window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onTouchEnd)},onTouchMoving:function(t){this.onMouseMove(t.touches[0])},onMouseMove:function(t){this.elem.x+=t.clientX-this.pointer.x,this.elem.y+=t.clientY-this.pointer.y,this.isOnDropZone=this.elem.y<-200,this.pointer.x=t.clientX,this.pointer.y=t.clientY},handleCardMove:function(){-1!==this.selectedCard&&this.sortedCards[this.selectedCard]&&this.$emit("cardmove",this.sortedCards[this.selectedCard])}},mounted:function(){this.isMounted=!0}},Ct=bt,wt=(n("a561"),Object(h["a"])(Ct,ut,dt,!1,null,null,null)),Rt=wt.exports,At=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"player_emotion_controller"},t._l(t.emotions,(function(e){return n("div",{key:e,staticClass:"emoji_block",on:{click:function(n){return t.setEmotion(e)}}},[t._v(t._s(e))])})),0)},St=[],xt=[],jt={name:"PlayerEmotionController",data:function(){return{emotions:[]}},methods:{loadEmotions:function(){var t=this;xt.length?this.emotions=xt:T.get("emotions").then((function(e){var n=e.data;xt=n,t.emotions=n}))},setEmotion:function(t){this.$emit("setEmotion",t)}},mounted:function(){this.loadEmotions()}},Et=jt,Ot=(n("a968"),Object(h["a"])(Et,At,St,!1,null,"46c5548c",null)),Tt=Ot.exports,Pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"player_emoji_gallery"},[t._m(0),n("hamburger-menu",{staticClass:"closer",attrs:{"is-close":!0},on:{click:function(e){return t.$emit("close")}}}),n("div",{staticClass:"avatars scroll_page"},t._l(t.avatars,(function(e){return n("div",{key:e,staticClass:"emoji_block",on:{click:function(n){return t.setAvatar(e)}}},[t._v(t._s(e))])})),0)],1)},Ut=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tabs"},[n("div",{staticClass:"tab tab-selected"},[t._v("Select Avatar")])])}],It=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"hamburger_menu hamburger_menu-default",class:{"hamburger_menu-closer":t.isClose},on:{click:t.handleClick}},[n("span",{staticClass:"filler"})])},Mt=[],$t={name:"HamburgerMenu",props:["isClose"],methods:{handleClick:function(t){this.$emit("click",t)}}},Dt=$t,Bt=(n("803a"),Object(h["a"])(Dt,It,Mt,!1,null,null,null)),Gt=Bt.exports,Lt=[],Nt={name:"playerEmojiGallery",components:{HamburgerMenu:Gt},data:function(){return{avatars:[]}},methods:{setAvatar:function(t){this.$emit("setAvatar",t)},loadAvatars:function(){var t=this;Lt.length?this.avatars=Lt:T.get("avatars").then((function(e){var n=e.data;console.log(n),Lt=n,t.avatars=n}))}},mounted:function(){this.loadAvatars()}},Yt=Nt,Wt=(n("e27d"),Object(h["a"])(Yt,Pt,Ut,!1,null,"74fb0924",null)),Ht=Wt.exports,Qt={name:"player-controller",components:{PlayerEmojiGallery:Ht,PlayerEmotionController:Tt,PlayerHand:Rt},props:["socket","adminId"],data:function(){return{showEmojiGallery:!1,emotions:[]}},computed:{player:function(){return this.$store.state.user},isReady:function(){return this.player.isReady},playerState:function(){return this.player.isConnected?this.player.isReady?"Ready":"Waiting":"Offline"}},mounted:function(){this.getPlayerState(),this.listenSocket()},methods:{openEmojiGallery:function(){this.showEmojiGallery?this.showEmojiGallery=!1:(this.showEmojiGallery=!0,this.emotions=[])},changeAvatar:function(t){var e=this;this.socket.emit("change avatar",t,(function(t){e.updateUserState(t),e.showEmojiGallery=!1}))},sendEmotion:function(t){this.showEmojiGallery=!1,this.socket.emit("emote",t)},updateUserState:function(t){this.$store.commit("setUser",t)},getPlayerState:function(){var t=this;this.socket.emit("get player data",(function(e){t.updateUserState(e)}))},listenSocket:function(){var t=this;this.socket.on("player update",(function(e){var n=Object(lt["a"])({},t.player,{},e);t.updateUserState(n)})),this.socket.on("emote",(function(e,n){if(t.player.id===e){var o=(new Date).getTime().toString();t.emotions.push({id:o,value:n}),setTimeout((function(){var e=Object(Y["a"])(t.emotions),n=e.findIndex((function(t){return t.id===o}));-1!==n&&(e.splice(n,1),t.emotions=Object(Y["a"])(e))}),1500)}}))},setReadyState:function(t){var e=this;this.socket.emit("set player ready state",t,(function(t){e.updateUserState(t)}))},sendCard:function(t){console.log(t),this.socket.emit("send card",t.id)},takeCard:function(){this.socket.emit("take card")},startGame:function(){this.socket.emit("start room game")}}},Zt=Qt,Vt=(n("d544"),Object(h["a"])(Zt,it,ct,!1,null,null,null)),Kt=Vt.exports,qt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"desk"},t._l(t.cards,(function(e){return n("div",{key:e.id,staticClass:"desk-card_wrapper"},[n("Card",t._b({},"Card",e,!1))],1)})),0)},Xt=[],zt={name:"desk",components:{Card:yt},props:["cards"]},Jt=zt,Ft=(n("4bbb"),Object(h["a"])(Jt,qt,Xt,!1,null,null,null)),te=Ft.exports,ee=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"room_controller"},[t.user?n("div",[t._v("Player: "+t._s(t.user.name))]):t._e(),t._v(" Room: #"+t._s(t.roomId)+" "),n("ul",{staticClass:"room_menu"},[n("li",{on:{click:t.saveUriToClipboard}},[t._v("Copy invite link")]),t.isAdmin?n("li",{on:{click:t.startRestart}},[t._v("Restart Game")]):t._e()])])},ne=[],oe=function(t){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)},ae=oe,re={name:"room-controller",props:["socket","adminId","roomId"],methods:{saveUriToClipboard:function(){var t=window.location.href;ae(t),this.$notify("Link copied to your clipboard")},startRestart:function(){this.socket.emit("finish game")}},computed:{user:function(){return this.$store.state.user},isAdmin:function(){return this.user&&this.user.id===this.adminId}}},se=re,ie=(n("ea75"),Object(h["a"])(se,ee,ne,!1,null,null,null)),ce=ie.exports,le={name:"Room",components:{HamburgerMenu:Gt,RoomController:ce,Desk:te,PlayerController:Kt,Players:st},props:["id"],data:function(){return{socket:null,players:[],state:null,game:null,adminId:null,showSidebar:!1}},mounted:function(){this.connectToRoom()},computed:{user:function(){return this.$store.state.user},activeUsers:function(){return this.players.filter((function(t){return t.isReady||t.isConnected}))},opponents:function(){var t=this,e=this.activeUsers.findIndex((function(e){return t.user&&e.id===t.user.id}));return-1===e?this.activeUsers:[].concat(Object(Y["a"])(this.activeUsers.slice(e+1)),Object(Y["a"])(this.activeUsers.slice(0,e)))}},methods:{connectToRoom:function(){this.socket=H.a.connect("".concat(E(3333),"?room=").concat(this.id,"&user=").concat(this.user.id)),this.socket.on("connect",this.handleSocketConnect),this.listenSocket()},handleRoomUpdate:function(t){var e=t.players,n=t.state,o=t.game,a=t.adminId;this.players=e,this.state=n,this.game=o,this.adminId=a},handleSocketConnect:function(){this.getRoomData()},getRoomData:function(){this.socket.emit("get room data",this.handleRoomUpdate)},listenSocket:function(){var t=this;this.socket.on("exception",(function(e){console.error("exception",e),t.$notify({type:"error",text:e})})),this.socket.on("room update",this.handleRoomUpdate)}}},ue=le,de=(n("5ca1"),Object(h["a"])(ue,L,N,!1,null,null,null)),me=de.exports,pe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"room_old"},[t._v(" ROOM "+t._s(t.id)),n("br"),t._v(" Room status: "+t._s(t.state)),n("br"),t.socket?n("PlayerController",{attrs:{socket:t.socket}}):t._e(),t._l(t.players,(function(e){return n("Player",t._b({key:e.id},"Player",e,!1))})),t.game&&t.game.desk?n("div",t._l(t.game.desk,(function(e){return n("Card",t._b({key:e.id,staticStyle:{display:"inline-block",width:"50px"}},"Card",e,!1))})),1):t._e()],2)},fe=[],he=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["wait"===t.player.state?[t.isReady?t._e():n("button",{on:{click:function(e){return t.setReadyState(!0)}}},[t._v("I'm ready")]),t.isReady?n("button",{on:{click:function(e){return t.setReadyState(!1)}}},[t._v("I'm not ready")]):t._e()]:["idle"===t.player.state?t._l(t.sortedCards,(function(e){return n("span",{key:e.id},[n("Card",t._b({staticStyle:{display:"inline-block",width:"50px"}},"Card",e,!1))],1)})):t._e(),"turn"===t.player.state?[t._l(t.sortedCards,(function(e){return n("Card",t._b({key:e.id,staticStyle:{cursor:"pointer",display:"inline-block",margin:"0 5px",width:"50px"},on:{click:function(n){return t.sendCard(e)}}},"Card",e,!1))})),n("div",[n("button",{on:{click:t.takeCard}},[t._v("Take card")])])]:t._e()]],2)},ve=[],ye={name:"player-controller",components:{Card:yt},props:["socket"],data:function(){return{}},computed:{player:function(){return this.$store.state.user},isReady:function(){return this.player.isReady},sortedCards:function(){return this.player?gt(this.player.cards):[]}},mounted:function(){this.getPlayerState(),this.listenSocket()},methods:{updateUserState:function(t){this.$store.commit("setUser",t)},getPlayerState:function(){var t=this;this.socket.emit("get player data",(function(e){t.updateUserState(e)}))},listenSocket:function(){var t=this;this.socket.on("player update",(function(e){var n=Object(lt["a"])({},t.player,{},e);t.updateUserState(n)}))},setReadyState:function(t){var e=this;this.socket.emit("set player ready state",t,(function(t){e.updateUserState(t)}))},sendCard:function(t){console.log(t),this.socket.emit("send card",t.id)},takeCard:function(){this.socket.emit("take card")}}},_e=ye,ke=Object(h["a"])(_e,he,ve,!1,null,null,null),ge=ke.exports,be={name:"RoomOld",components:{PlayerController:ge,Player:nt,Card:yt},props:["id"],data:function(){return{socket:null,players:[],state:null,game:null}},mounted:function(){this.connectToRoom()},computed:{user:function(){return this.$store.state.user}},methods:{connectToRoom:function(){this.socket=H.a.connect("".concat(E(3333),"?room=").concat(this.id,"&user=").concat(this.user.id)),this.socket.on("connect",this.handleSocketConnect),this.listenSocket()},handleRoomUpdate:function(t){var e=t.players,n=t.state,o=t.game;this.players=e,this.state=n,this.game=o},handleSocketConnect:function(){this.getRoomData()},getRoomData:function(){this.socket.emit("get room data",this.handleRoomUpdate)},listenSocket:function(){this.socket.on("exception",(function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];(t=console).error.apply(t,["exception"].concat(n))})),this.socket.on("room update",this.handleRoomUpdate)}}},Ce=be,we=Object(h["a"])(Ce,pe,fe,!1,null,null,null),Re=we.exports;o["default"].use(k["a"]);var Ae=[{path:"/",name:"Home",component:G,props:!0},{path:"/defRoom:defRoom",name:"DefRoom",component:G,props:!0},{path:"/room:id",name:"Room",component:me,props:!0,beforeEnter:function(t,e,n){b.state.user?n():n({name:"DefRoom",params:{defRoom:t.params.id}})}},{path:"/devroom:id",name:"RoomOld",component:Re,props:!0,beforeEnter:function(t,e,n){b.state.user?n():n({name:"Home"})}}],Se=new k["a"]({mode:"history",base:"/",routes:Ae}),xe=Se;n("c5c5");o["default"].use(r.a),o["default"].use(l.a),o["default"].use(i.a,{disableClick:!0}),o["default"].config.productionTip=!1,new o["default"]({router:xe,store:b,render:function(t){return t(y)}}).$mount("#app")},d544:function(t,e,n){"use strict";var o=n("2e9b"),a=n.n(o);a.a},e27d:function(t,e,n){"use strict";var o=n("72f9"),a=n.n(o);a.a},e294:function(t,e,n){},e29a:function(t,e,n){},ea75:function(t,e,n){"use strict";var o=n("0059"),a=n.n(o);a.a},f255:function(t,e,n){},f52b:function(t,e,n){},fada:function(t,e,n){}});
//# sourceMappingURL=app.f6ef9c3a.js.map